name: Deploy mdBook to GitHub Pages

on:
  workflow_dispatch:
  push:
    branches:
      - main  
    
jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2

    - name: Setup Rust
      uses: actions-rs/toolchain@v1
      with:
        profile: minimal
        toolchain: stable
        override: true

    - name: Install mdBook
      run: cargo install mdbook

    - name: Install mdBook preprocessors
      run: |
        cargo install mdbook-collector
        cargo install mdbook-tagger
        cargo install mdbook-tocjs
        cargo install mdbook-catppuccin
        mdbook-catppuccin install

    - name: Build mdBook
      run: mdbook build

    - name: Setup Pages
      uses: actions/configure-pages@v4
    - name: Upload artifact
      uses: actions/upload-pages-artifact@v3
      with:
    # Upload entire repository
        path: 'book'
        
    - name: Deploy to GitHub Pages
      id: deployment
      uses: actions/deploy-pages@v4
